<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onetouch.dao.ReplyDao">
<<<<<<< HEAD

<!-- 댓글 그룹화로 조회 -->
	<select id="selectReplyList" parameterType="map" resultType="ReplyVo">
		select r.*,m.mem_id from reply as r 
		Join mem as m on r.mem_idx =m.mem_idx
		<if test="postReplyIdxPageList !=null and postReplyIdxPageList.size()>0">
		WHERE r.reply_idx IN
		<foreach collection="postReplyIdxPageList" item="vo" open="(" separator="," close=")">
			#{vo.reply_idx}
		</foreach>
		</if>
		<if test="postReplyIdxPageList ==null or postReplyIdxPageList.size() == 0">
	    WHERE 1=0
	    </if>	
		ORDER BY r.reply_idx DESC
	</select>
	
	<!-- 댓글 페이지 처리를 위한 post_idx 기준의 reply_idx list 가져오기 -->
	<select id="selectReplyIdxPageList" parameterType="map" resultType="ReplyPageVo">
	SELECT reply_idx 
	FROM otdb.reply 
	WHERE post_idx=#{post_idx}
	ORDER BY reply_idx DESC 
	LIMIT #{page}, #{block_list};
	
	</select>
	
	<select id="selectPostIdxReplyTotalCount" parameterType="map">
		SELECT count(*) FROM reply WHERE post_idx=#{post_idx};
	</select>
	
	<!-- post 댓글 추가 -->
=======
>>>>>>> 4449e6b8f0c1c6a293c456ca10b73466f341cc51
	<insert id="insertPostReply" parameterType="ReplyVo">
		INSERT INTO reply(
							reply_idx
							,mem_idx
							,post_idx
							,reply_content
							,reply_delete
							) 
					values(
							null
							,#{mem_idx}
							,#{post_idx}
							,#{reply_content}
							,0
							)
	</insert>
</mapper>