<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onetouch.dao.OrderDao">
<insert id="insert" parameterType="order" useGeneratedKeys="true" keyProperty="order">
	insert into order(
		mem_idx,
		order_no,
		order_status,
		total_amount,
		order_name,
		order_mem_name,
		order_phone,
		order_postal,
		order_address,
		order_address_more,
		order_time
	) values (
		#{mem_idx},
		#{order_no},
		'결제대기',
		#{total_amount},
		#{order_name},
		#{order_mem_name},
		#{order_phone},
		#{order_postal},
		#{order_address},
		#{order_address_more},
		now()
	)
</insert>

<!-- 단건 주문 조회 -->
<select id="selectOne" parameterType="int">
	select * from order where order_id = #{order_id}
</select>

<!-- 회원별 주문 목록 조회 -->
<select id="selectOne" parameterType="int">
	select * from order where mem_idx = #{mem_idx}
</select>

<!-- 주문번호로 조회 -->
<select id="selectOneByOrderNo" parameterType="string" resultType="order">
	select * from order o
		left join mem m on o.mem_idx = m.mem_idx
	where o.order_no = #{order_no}
</select>

<!-- 주문 내용 수정 -->
<update id="update" parameterType="order">
	update order set
		order_mem_name = #{order_mem_name},
		order_phone = #{order_phone},
		order_postal = #{order_postal},
		order_address = #{order_address},
		order_address_more = #{order_address_more},
		order_update = now()
	where order_id = #{order_id}
</update>

<!-- 주문 상태 수정 -->
<update id="updateStatus" parameterType="order">
	update order set 
		order_status = #{order_status},
		order_update = now()
	where order_id = #{order_id}
</update>

</mapper>