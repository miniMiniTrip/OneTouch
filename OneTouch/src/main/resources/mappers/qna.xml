<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.onetouch.dao.QnaDao">

  <!-- ✅ Q&A 목록 -->
    <!-- <select id="selectQnaList" resultType="QnaVo">
        SELECT 
            qna_idx,
            mem_idx,
            qna_title,
            qna_content,
            qna_category,
            qna_private,
            qna_answered,
            qna_answer_content,
            qna_delete,
            qna_time,
            qna_update,
            qna_answer_time
        FROM qna
        WHERE qna_delete = 0
        ORDER BY qna_idx DESC
    </select> -->
    
<select id="selectQnaList" resultType="com.onetouch.vo.QnaVo" parameterType="int">
      SELECT 
    qna.qna_idx,
    qna.mem_idx,
    mem.mem_name,          
    qna.qna_title,
    qna.qna_content,
    qna.qna_category,
    qna.qna_private,
    qna.qna_answered,
    qna.qna_answer_content,
    qna.qna_delete,
    qna.qna_time,
    qna.qna_update,
    qna.qna_answer_time
	FROM qna
	JOIN mem ON qna.mem_idx = mem.mem_idx   
	WHERE qna.qna_delete = 0   and qna.mem_idx=#{mem_idx}             
	ORDER BY qna.qna_idx DESC;   
</select>

    <!-- ✅ Q&A 상세보기 -->
    <!-- <select id="selectQnaDetail" parameterType="int" resultType="QnaVo">
        SELECT 
            qna_idx,
            mem_idx,
            qna_title,
            qna_content,
            qna_category,
            qna_private,
            qna_answered,
            qna_answer_content,
            qna_delete,
            qna_time,
            qna_update,
            qna_answer_time
        FROM qna
        WHERE qna_idx = #{qna_idx}
    </select> -->
    
    <select id="selectQnaDetail" parameterType="int" resultType="com.onetouch.vo.QnaVo">
        SELECT 
            qna.qna_idx,
            qna.mem_idx,
            mem.mem_name,
            qna.qna_title,
            qna.qna_content,
            qna.qna_category,
            qna.qna_private,
            qna.qna_answered,
            qna.qna_answer_content,
            qna.qna_delete,
            qna.qna_time,
            qna.qna_update,
            qna.qna_answer_time
        FROM qna
        JOIN mem ON qna.mem_idx = mem.mem_idx
        WHERE qna_idx = #{qna_idx}
    </select>

    
    
    <!--  Q&A 등록하기  -->
  <!--    <insert id="insertQna" parameterType="QnaVo">
    INSERT INTO qna (
        qna_idx,
        mem_idx, 
        qna_title,
        qna_content,
        qna_category, 
        qna_private,
		qna_answered,
		qna_answer_content,
        qna_delete,
        qna_time,
        qna_update,
        qna_answer_time
        
    )
    VALUES (
        #{qna_idx},
        #{mem_idx}, 
        #{qna_title}, 
        #{qna_content}, 
        #{qna_category}, 
        #{qna_private},
        #{qna_answered},
        #{qna_answer_content},
        #{qna_delete},
        #{qna_time},
        #{qna_update},
        #{qna_answer_time}
    )
</insert>  -->
<!-- 등록하기 -->
	<insert id="insertQna" parameterType="QnaVo" useGeneratedKeys="true" keyProperty="qna_idx">
    INSERT INTO qna (
        mem_idx, 
        qna_title,
        qna_content,
        qna_category, 
        qna_private,
        qna_answered,
        qna_answer_content,
        qna_delete
    )
    VALUES (
        #{mem_idx}, 
        #{qna_title}, 
        #{qna_content}, 
        #{qna_category}, 
        #{qna_private},
        #{qna_answered},
        #{qna_answer_content},
        #{qna_delete}
    )
</insert>

<!-- Q&A 수정 -->
<update id="updateQna" parameterType="com.onetouch.vo.QnaVo">
    UPDATE qna
    SET
        qna_title = #{qna_title},
        qna_content = #{qna_content},
        qna_category = #{qna_category},
        qna_private = #{qna_private},
        qna_update = NOW()
    WHERE qna_idx = #{qna_idx}
</update>

<!-- Q&A 삭제 (하드 삭제) -->

<delete id="deleteQna" parameterType="int">
    DELETE FROM qna WHERE qna_idx = #{qna_idx}
</delete>





</mapper>